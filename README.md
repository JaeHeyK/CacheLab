# CacheLab
A small C program (`csim.c`) that simulates the behavior of a cache memory

## Reference Trace Files
The traces subdirectory contains a collection of reference trace files that we will use to evaluate the
correctness of the cache simulator you will write. The trace files are generated by a Linux program called
valgrind. For example, typing

`linux> valgrind --log-fd=1 --tool=lackey -v --trace-mem=yes ls -l`

on the command line runs the executable program `ls -l`, captures a trace of each of its memory accesses
in the order they occur, and prints them on stdout.
Valgrind memory traces have the following form:

`I 0400d7d4,8` <br />
`M 0421c7f0,4` <br />
`L 04f6b868,8` <br />
`S 7ff0005c8,8` <br />

Each line denotes one or two memory accesses. The format of each line is
[space]operation address,size
The operation field denotes the type of memory access: `I` denotes an instruction load, `L` a data load,
`S` a data store, and `M` a data modify (i.e., a data load followed by a data store). There is never a space
before each `I`. There is always a space before each `M`, `L`, and `S`. The address field specifies a 64-bit
hexadecimal memory address. The size field specifies the number of bytes accessed by the operation.

## Cache Simulator
`csim.c` is a cache simulator that takes a valgrind memory trace as input, simulates the hit/miss behavior of a 
cache memory on this trace, and outputs the total number of hits, misses, and evictions.

- -v: Optional verbose flag that displays trace info
- -s: Number of set index bits (S = 2s is the number of sets)
- -E: Associativity (number of lines per set)
- -b: Number of block bits (B = 2b is the block size)
- -t: Name of the valgrind trace to replay
- -L: Set the cache eviction policy to be LRU.
- -F: Set the cache eviction policy to be FIFO.

The command-line arguments are based on the notation (s, E, and b) from page 617 of the CS:APP3e
textbook. For example:

`linux> ./csim-ref -s 4 -E 1 -b 4 -L -t traces/yi.trace` <br />
`hits:4 misses:5 evictions:3`

The same example in verbose mode:

`linux> ./csim-ref -v -s 4 -E 1 -b 4 -L -t traces/yi.trace` <br />
`L 10,1 miss` <br />
`M 20,1 miss hit` <br />
`L 22,1 hit` <br />
`S 18,1 hit` <br />
`L 110,1 miss eviction` <br />
`L 210,1 miss eviction` <br />
`M 12,1 miss eviction hit` <br />
`hits:4 misses:5 evictions:3` <br />

The `csim.c` file takes the same command line arguments and produces the identical output as the reference simulator.
